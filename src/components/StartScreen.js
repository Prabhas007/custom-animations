import React, { useEffect } from "react";
import "../styles/startScreen.css";

export default function StartScreen({ onFinish }) {
  useEffect(() => {
    const topPanel = document.querySelector(".start-screen__top");
    const bottomPanel = document.querySelector(".start-screen__bottom");

    const leftPath = document.getElementById("leaf-left");
    const rightPath = document.getElementById("leaf-right");
    const leafTrace = document.getElementById("leaf-trace");

    // NEW leaf SVG (center icon)
    const leaf = document.getElementById("start-leaf-svg");

    function animateTrace(path) {
      if (!path) return;
      const len = path.getTotalLength();

      path.style.strokeDasharray = `${len} ${len}`;
      path.style.strokeDashoffset = len;

      path.getBoundingClientRect(); // force layout

      path.style.transition = "stroke-dashoffset 1.6s ease-in-out";
      path.style.strokeDashoffset = "0";
    }

    // Run line tracing animation for the outline leaf
    animateTrace(leftPath);
    animateTrace(rightPath);

    // Animation sequence
    setTimeout(() => {
      leafTrace.classList.add("hide");  // fade out outline

      leaf.classList.add("show"); // fade in real SVG

      setTimeout(() => {
        leaf.classList.add("scaleDown"); // shrink

        setTimeout(() => {
          topPanel.classList.add("slideUp");
          bottomPanel.classList.add("slideDown");

          setTimeout(() => {
            onFinish();
          }, 600);
        }, 650);
      }, 550);
    }, 1500);
  }, [onFinish]);

  return (
    <div id="start-screen">

      {/* TOP PANEL */}
      <div className="start-screen__panel start-screen__top">
        <div className="start-screen__bg"></div>
      </div>

      {/* BOTTOM PANEL */}
      <div className="start-screen__panel start-screen__bottom">
        <div className="start-screen__bg"></div>
      </div>

      {/* LEAF CONTAINER */}
      <div id="start-leaf-container">
        <div className="leaf-aspect-ratio"></div>

        {/* OUTLINE TRACING SVG */}
        <svg
          id="leaf-trace"
          viewBox="0 0 1291.1 1458.3"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            id="leaf-left"
            strokeWidth="20"
            stroke="white"
            fill="none"
            d="m603.22,798.07 0,0 s0-0.37392-1.6826-1.1218l-2.7109,0.18696-2.524,0.28046-1.8696,0.46741s-2.5105,0.12238-7.8944,3.675l-7.4362,6.0468-12.713,10.47-26.174,23.183-20.192,19.444-17.948,17.2-20.939,20.939-26.174,26.174-23.183,26.174-49.357,51.6-37.392,41.13-24.679,27.67-42.627,47.114-25.426,29.166c-49.357,55.34-49.357,55.34-49.357,55.34l-35.148,41.131-45.618,53.096-35.896,40.383-9.7218,11.965-5.2348-15.705-10.47-32.157-12.713-41.879-8.974-40.383-6.7305-31.409-8.2262-51.6-4.487-41.879-2.2435-39.635-0.74784-38.887 0.74784-39.634 2.2435-47.114 5.2348-47.861 6.7305-39.635 3.7392-20.192 2.9913-14.957 5.2348-22.435 8.974-27.67 9.7218-31.409 9.7218-24.679 12.713-29.913 16.452-33.653 16.452-31.409 14.957-26.174 17.948-27.67 27.67-38.14 22.435-27.67 16.452-20.192 17.948-19.444 23.931-23.183 27.67-27.67 26.174-21.687 27.67-23.183 18.696-14.209 19.444-14.957 18.696-14.209 30.661-20.192 26.174-17.948 28.418-16.452 35.148-21.687 24.679-13.461 32.905-16.452 20.939-11.218 25.426-12.713 29.166-14.209 28.418-12.713 28.418-12.713 32.905-9.7218 34.4-13.461 29.166-8.9741 26.922-8.9739 33.653-10.47 26.922-8.2262 30.661-7.4783 35.148-9.7219 37.392-7.4783 25.426-5.9827 35.896-7.4783 36.644-7.4783 34.4-4.487 34.4-4.487 33.652-3.7392 14.957-0.7478 13.461-0.7479 h11.218 l17.2 2.2435"
          />

          <path
            id="leaf-right"
            strokeWidth="20"
            stroke="white"
            fill="none"
            d="m602.45,797.51 0.74783,0.74783 0.9348,1.6826 0.37391,2.4305-0.74783,3.1783-0.56088,2.4304-4.674,14.583-8.974,18.696-10.47,17.948-16.452,26.174-18.696,28.418-14.209,21.687-21.687,31.409-15.704,20.939-16.452,23.93-16.452,21.687-110.68,150.31-13.461,17.948-170.51,222.11-1.4957,2.9913 15.705,4.487 22.435,4.487 30.661,4.487 28.418,1.4957 25.426,1.4957 28.418,2.9913 38.887,0 27.67-2.2435 52.348-6.7305 38.14-7.4784 35.148-6.7305 35.896-8.2261 41.131-14.209 46.366-18.696 38.887-18.696 42.627-23.183 38.887-24.678 48.609-32.157 41.879-35.148 52.348-48.609 35.896-38.14 30.661-35.896 30.661-39.635 29.913-41.879 29.913-44.121 32.905-53.844 22.435-42.627 17.948-34.4 14.957-32.157 17.2-34.4 23.183-56.835 16.452-41.131 19.444-54.592 12.713-47.861 15.704-59.079 10.47-56.088 5.2349-37.392 6.7305-54.592 5.2348-45.618 2.2435-50.105 0.7479-47.861-2.2435-50.853-3.7392-47.861-4.487-37.392-5.9827-39.635-4.487-28.418-3.7392-17.2-3.7391-17.2"
          />
        </svg>

        {/* CENTER ICON LEAF (visible after tracing) */}
        <svg
          id="start-leaf-svg"
          width="200"
          height="200"
          viewBox="0 0 512 512"
          xmlns="http://www.w3.org/2000/svg"
        >
          {/* <g fill="#ffffff">
            <path d="M74.96,407.064c3.061-82.464,41.669-165,106.747-225.632c39.177-36.509,84.732-62.947,135.396-78.57 c0.738-0.232,1.482-0.4,2.228-0.617c-0.697-2.003-1.266-4.07-2.027-6.033C301.112,54.055,270.837,21.384,233.206,0 c-41.725,12.947-80.005,35.812-112.236,67.626c-32.158,31.798-58.1,72.425-73.186,119.83 c-15.062,47.389-17.033,94.834-7.604,138.185C46.655,355.124,58.335,382.844,74.96,407.064z.96,407.064c3.061-82.464,41.669-165,106.747-225.632..." />
            <path d="M460.504,114.246c-45.033-5.744-91.501-1.546-136.15,12.122c-44.665,13.788-87.824,37.615-125.871,73.074 c-69.901,65.134-104.392,153.439-98.479,236.359c-9.87,7.499-19.845,14.918-30.116,22.24c-10.375,7.283-20.614,14.614-33.392,21.84 L54.707,512c15.134-8.604,25.717-16.272,36.597-23.891c10.712-7.635,20.942-15.246,31.037-22.922 c79.099,27.336,181.792,5.84,260.746-67.722c42.83-39.874,72.338-89.547,85.917-140.228 C482.705,206.604,479.988,155.194,460.504,114.246z M406.778,187.89c-19.974,29.17-50.193,63.972-82.72,98.326 c28.898-4.735,51.996-9.038,63.06-11.16c4.655-0.889,7.17-1.395,7.178-1.395c4.446-0.889,8.765,1.995,9.654,6.434 c0.889,4.447-1.995,8.765-6.434,9.654c-0.08,0.016-39.986,7.988-92.302,16.095c-5.768,5.913-11.561,11.777-17.337,17.553 c-17.61,17.602-35.01,34.386-51.09,49.464c39.554-6.145,80.044-14.372,99.801-18.555c7.852-1.658,12.403-2.668,12.418-2.676 c4.422-0.977,8.804,1.81,9.79,6.233c0.977,4.423-1.81,8.804-6.233,9.79c-0.121,0.016-74.012,16.456-136.062,24.732l-0.969,0.128 c-16.232,14.782-30.124,26.888-40.043,35.003v0.008c-3.5,2.868-8.676,2.347-11.544-1.162c-2.868-3.5-2.347-8.676,1.162-11.544 c10.343-8.461,25.469-21.688,43.183-37.919c0.505-3.557,1.058-8.044,1.634-13.275c0.969-8.782,2.002-19.452,3.02-30.661 c2.044-22.408,4.006-46.948,5.256-62.988c0.833-10.687,1.346-17.578,1.346-17.593c0.336-4.519,4.27-7.908,8.789-7.571 c4.519,0.329,7.908,4.27,7.572,8.789c0,0.032-4.615,62.323-8.669,102.317c-0.136,1.338-0.264,2.508-0.4,3.781 c15.599-14.653,32.456-30.916,49.44-47.901c5.992-5.993,11.993-12.074,17.978-18.203c2.452-9.806,4.246-25.444,5.32-41.116 c1.194-16.961,1.666-34.105,1.859-45.073c0.128-7.307,0.128-11.833,0.128-11.842c0-4.534,3.669-8.204,8.204-8.204 s8.204,3.67,8.204,8.204c-0.008,0.144,0.016,41.741-3.509,75.27c-0.072,0.649-0.153,1.266-0.225,1.906 c31.414-33.312,60.336-66.801,79.003-94.113c2.556-3.741,7.659-4.694,11.401-2.139C408.38,179.044,409.333,184.148,406.778,187.89z" />
          </g> */}
        </svg>

      </div>
    </div>
  );
}
